<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <meta name="description" content="UniPass">
  <meta name="author" content="SAGA">
  <link rel="shortcut icon" href="../img/tabicon.png" type="image/x-icon">
  <title>Dettagli Viaggio | UNIPASS</title>
  <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <link href="../css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body style="height: 100%; min-height: 100%;">
<nav class="navbar">
  <div class="container-fluid">
    <a class="navbar-brand center_mob" href="/home"><img class="img-responsive" src="../img/logoUniPass.png"></a>
    <form class="d-flex center_mob" th:if="${session.utenteLoggato['getTipo']  == 'passeggero'}">
      <a class="list-group-item" href="/storico-viaggi"><i class="fa fa-history button-icon" aria-hidden="true"></i>&nbsp; STORICO VIAGGI</a>
      <a class="list-group-item" href="/pagina-utente-passeggero"><i class="fa fa-user-o button-icon" aria-hidden="true"></i>&nbsp; PROFILO</a>
    </form>

    <form class="d-flex center_mob" th:if="${session.utenteLoggato['getTipo']  == 'guidatore'}">
      <a class="list-group-item" href="/storico-viaggi"><i class="fa fa-history button-icon" aria-hidden="true"></i>&nbsp; STORICO VIAGGI</a>
      <a class="list-group-item" href="/pagina-utente-guidatore"><i class="fa fa-user-o button-icon" aria-hidden="true"></i>&nbsp; PROFILO</a>
    </form>
  </div>
</nav>

<nav class="navbar navbar-expand-md" style="background-color: #3d3e3e">
  <div class="center">
    <button style="background-color:#FECC18;color:white;" class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon" style="color:white;"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a href="/home" style="color:#ffffff" class="nav-link testo_nav" aria-current="page"><i class="fa fa-home"></i><span> HOME</span></a>
        </li>
        <li class="nav-item">
          <a href="#" style="color:#ffffff" class="nav-link testo_nav"><i class="fa fa-car"></i><span> CREA VIAGGIO</span></a>
        </li>
        <li class="nav-item">
          <a href="#" style="color:#ffffff" class="nav-link testo_nav" ><i class="fa fa-search"></i><span> CERCA VIAGGI</span></a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<hr class="spacer">

<div class="container-fluid" style="margin-top: 5%; margin-bottom: 5%;">
  <div class="row">
    <div class="col-md-5">
      <hr>
    </div>
    <div class="col-md-2">
      <h3 class="center">Dettagli viaggio</h3>
    </div>
    <div class="col-md-5">
      <hr>
    </div>
  </div>
</div>

<div class="container-fluid center-mob" style="margin-top: 1%; margin-bottom: 3%;">
  <div class="row">
    <div style="margin-left: 5%;" class="col-md-4">

      <div class="bz80">
        <label style="color:#fecc18"><strong>ID: </strong></label>
        <a th:text="${session.viaggio['getIdViaggio']}"></a>
      </div>

      <div class="bz80" style="margin-top: 8%;">
        <label style="color:#fecc18"><strong>Destinazione: </strong></label>
        <a th:text="${session.viaggio['getDestinazione']}"></a>
      </div>
      <div class="bz80" style="margin-top: 8%;">
        <label style="color:#fecc18"><strong>Data e ora: </strong></label>
        <a th:text="${session.viaggio['getDataOraPartenza']}"></a>
      </div>
      <div class="bz80" style="margin-top: 8%;">
        <label style="color:#fecc18"><strong>Stato: </strong></label>
        <a th:if="${session.viaggio['isPrenotabile'] == true}"> Prenotazioni aperte</a>
        <a th:if="${session.viaggio['isPrenotabile'] == false}"> Prenotazioni chiuse</a>
      </div>
    </div>
    <div style="margin-right: auto" class="col-md-4">
      <div class="bz80">
        <label style="color:#fecc18"><strong>Prezzo: </strong></label>
        <a th:text="${session.viaggio['getPrezzo']}"></a>
      </div>
      <div class="bz80" style="margin-top: 8%;">
        <label style="color:#fecc18"><strong>Posti per il viaggio: </strong></label>
        <a th:text="${session.viaggio['getPosti']}"></a>
      </div>
      <div class="bz80" style="margin-top: 8%;">
        <label style="color:#fecc18"><strong>Numero passeggeri: </strong></label>
        <a th:text="${session.viaggio['getListaPasseggeri'].size}"></a>
      </div>
    </div>
    <div class="col-md-4">

    </div>
  </div>
</div>
</div>

<div id="conf-valutazione" style="display: none;">

</div>

<div class="container-fluid" style="margin-top: 5%; margin-bottom: 5%;" th:if="${session.utenteLoggato.email != session.viaggio.getGuidatore.email}">
  <div class="row">
    <div class="col-md-5">
      <hr>
    </div>
    <div class="col-md-2">
      <h3 class="center">Dettagli guidatore</h3>
    </div>
    <div class="col-md-5">
      <hr>
    </div>
  </div>
</div>

<div class="table-responsive" style="margin-top: 5%;" th:if="${session.utenteLoggato.email != session.viaggio.getGuidatore.email}">
  <div class="center">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">Nome</th>
        <th scope="col">Cognome</th>
        <th scope="col">E-mail</th>
        <th scope="col">Valuta guidatore</th>
        <th scope="col">Media valutazione</th>
      </tr>
      </thead>
      <tbody th:with="guidatore = ${session.viaggio.getGuidatore}">
      <tr>
        <td th:text="${guidatore.nome}">Roberto</td>
        <td th:text="${guidatore.cognome}">De Prisco</td>
        <td th:text="${guidatore.email}">robedep@unisa.it</td>
        <td>
          <form class="rating rMB">
            <label>
              <input type="radio" name="stars" value="1"/>
              <span class="icon">★</span>
            </label>
            <label>
              <input type="radio" name="stars" value="2">
              <span class="icon">★</span>
              <span class="icon">★</span>
            </label>
            <label>
              <input type="radio" name="stars" value="3">
              <span class="icon">★</span>
              <span class="icon">★</span>
              <span class="icon">★</span>
            </label>
            <label>
              <input type="radio" name="stars" value="4">
              <span class="icon">★</span>
              <span class="icon">★</span>
              <span class="icon">★</span>
              <span class="icon">★</span>
            </label>
            <label>
              <input type="radio" name="stars" value="5">
              <span class="icon">★</span>
              <span class="icon">★</span>
              <span class="icon">★</span>
              <span class="icon">★</span>
              <span class="icon">★</span>
            </label>
          </form>
        </td>
        <td th:if="${guidatore['getNumeroValutazioniGuidatore'] == 0}">0</td>
        <td th:if="${guidatore['getNumeroValutazioniGuidatore'] > 0}" th:text="${guidatore['getSommaValutazioniGuidatore'] /  guidatore['getNumeroValutazioniGuidatore']}">2</td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<div class="container-fluid" style="margin-top: 5%; margin-bottom: 5%;" th:if="${session.utenteLoggato['getEmail'] == session.viaggio.getGuidatore['getEmail']}">
  <div class="row">
    <div class="col-md-5">
      <hr>
    </div>
    <div class="col-md-2">
      <h3 class="center">Dettagli passeggeri</h3>
    </div>
    <div class="col-md-5">
      <hr>
    </div>
  </div>
</div>

<div class="table-responsive" style="margin-top: 5%; min-height: 300px;" th:if="${session.utenteLoggato['getEmail'] == session.viaggio.getGuidatore['getEmail']}">
  <div class="center" th:with="passeggeri = ${session.viaggio['getListaPasseggeri']}">
    <table class="table" th:if="${passeggeri.size > 0}">
      <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Nome</th>
        <th scope="col">Cognome</th>
        <th scope="col">Email</th>
        <th scope="col">Valuta passeggero</th>
        <th scope="col">Media valutazione</th>
        <th scope="col"></th>
      </tr>
      </thead>
      <tbody th:each="p, iter : ${passeggeri}" th:with="counter = 0">
      <tr th:with="counter = ${iter.index + 1}">
        <th th:text="${counter}" scope="row">1</th>
        <td th:text="${p['getNome']}">Roberto</td>
        <td th:text="${p['getCognome']}">De Prisco</td>
        <td th:text="${p['getEmail']}">robedep@unisa.it</td>
        <td>
          <form action="/valuta-passeggero" method="post" >
            <div class="rating rMB">
              <label>
                <input type="radio" name="valutazione" value="1" />
                <span class="icon">★</span>
              </label>
              <label>
                <input type="radio" name="valutazione" value="2" />
                <span class="icon">★</span>
                <span class="icon">★</span>
              </label>
              <label>
                <input type="radio" name="valutazione" value="3" />
                <span class="icon">★</span>
                <span class="icon">★</span>
                <span class="icon">★</span>
              </label>
              <label>
                <input type="radio" name="valutazione" value="4" />
                <span class="icon">★</span>
                <span class="icon">★</span>
                <span class="icon">★</span>
                <span class="icon">★</span>
              </label>
              <label>
                <input type="radio" name="valutazione" value="5" />
                <span class="icon">★</span>
                <span class="icon">★</span>
                <span class="icon">★</span>
                <span class="icon">★</span>
                <span class="icon">★</span>
              </label>
            </div>
            <input type="hidden" name="idViaggio" th:value="${session.viaggio['getIdViaggio']}">
            <input type="hidden" name="email" th:value="${p['getEmail']}">
            <button type="submit" name="valuta">OK</button>
          </form>
        </td>
        <td th:if="${p['getNumeroValutazioniPasseggero'] == 0}">0</td>
        <td th:if="${p['getNumeroValutazioniPasseggero'] > 0}" th:text="${p['getSommaValutazioniPasseggero'] / p['getNumeroValutazioniPasseggero']}">2</td>
        <td>
          <form action="/escludi-passeggero" method="post">
            <input type="hidden" name="idViaggio" th:value="${session.viaggio['getIdViaggio']}">
            <input type="hidden" name = "emailPasseggero" th:value="${p['getEmail']}">
            <button class="btn btn-primary btn-dettagli" type="submit">ESCLUDI<br>PASSEGGERO</button>
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<footer style="clear: both; position: relative; height: 80px;" class="center">
  <div style="margin-top: 1%; margin-bottom: 1%;">
    <div class="row">
      <div class="col-4 col-sm-4 d-none d-lg-block">
        <a class="navbar-brand center_mob" href="/home"><img class="img-responsive" src="../img/logoUniPassFooter.png"></a>
      </div>
      <div class="col-4 col-sm-4" style="padding-bottom: 0%">
        <div><a style="padding: 1%; display: inline" class="list-group-item" href="#"><i class="fa fa-question-circle-o" aria-hidden="true"></i>&nbsp  CHI SIAMO</a></div>
        <div><a style="padding: 1%; display: inline" class="list-group-item" href="#"><i class="fa fa-phone" aria-hidden="true"></i>&nbsp CONTATTI</a></div>
      </div>
      <div class="col-4 col-sm-4 d-md-none d-block"></div>
      <div style="text-align: center" class="col-4 col-sm-4">
        <p>©Copyright 2023<br>S.A.G.A.</p>
      </div>
    </div>
  </div>
</footer>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../js/modVIs.js"></script>

</body>
</html>